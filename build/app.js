(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function (global){
'use strict';

angular.module('app', ['infinite-scroll']).constant('ENDPOINT_URI', 'http://localhost:8001/api/').controller('MainCtrl', ['$scope', '$http', 'ENDPOINT_URI', function ($scope, $http, ENDPOINT_URI) {

   var vm = this;
   var loadedThreadList = [];
   var currPage = 13;
   var nextPage = false;
   var canAdd = true;
   vm.threadList = [];

   vm.enableAddMore = function () {
      return canAdd = true;
   };
   vm.disableAddMore = function () {
      return canAdd = false;
   };

   vm.addMore = function (force) {

      if (!canAdd && !force) {
         return;
      }

      if (loadedThreadList.length > 0) {

         vm.threadList.push(loadedThreadList.shift());
         console.log('loading thread:', vm.threadList.length);
      } else {

         console.log('end of page.');

         if (nextPage) {
            loadThread();
            nextPage = false;
         }
      }
   };

   global.MORE = function () {
      vm.addMore();
      $scope.$apply();
   };

   function loadThread() {

      console.log('loading page:', currPage);
      $http.get(ENDPOINT_URI + 'thread/' + currPage).success(function (loadedThreadList_) {

         console.log(loadedThreadList_.length);
         console.log(loadedThreadList_);
         loadedThreadList = loadedThreadList_;

         currPage++;
         nextPage = true;

         vm.addMore();
         vm.addMore();
      }).error(function (err) {
         console.warn(err);
      });
   }

   loadThread();
}]).directive('threadList', [function () {

   return {

      restrict: 'E',
      scope: true,
      template: '<thread-item ng-repeat="thread in main.threadList"></thread-item>'

   };
}]).directive('threadItem', ['$http', 'ENDPOINT_URI', function ($http, ENDPOINT_URI) {

   function controller($scope) {

      $scope.main.disableAddMore();

      $scope.loadComplete = false;
      var totalImgs = 0;
      var loaded = 0;

      $scope.itemEnd = function () {
         loaded++;
         if (loaded >= totalImgs) {

            $scope.loadComplete = true;
            $scope.main.enableAddMore();

            $scope.$apply();
            console.log('complete', $scope);
            console.log('----------------------------');
         }
      };

      $http.post(ENDPOINT_URI + 'post', { thread: $scope.thread }).success(function (res) {

         $scope.imgUrlList = res.imgUrlList;
         totalImgs = res.imgUrlList.length;

         console.log('loading', totalImgs, 'imgs');

         if (totalImgs === 0) {
            $scope.loadComplete = true;
            $scope.main.enableAddMore();
            console.log('complete', $scope);
         }
      }).error(function (err) {

         console.warn('threadItem directive POST ERR:', err);
         $scope.loadComplete = true;
         $scope.main.enableAddMore();
      });
   }

   return {

      restrict: 'E',
      replace: true,
      scope: true,
      controller: controller,
      controllerAs: 'tItem',
      template: ['<div>', '<div ng-hide="loadComplete" style="height: 50px; background: #c3c3c3">', 'LOADING...', '</div>', '<div ng-show="loadComplete">', '<thread-img ng-repeat="url in imgUrlList"></thread-img>', '<br>', '<a href="{{thread}}">{{thread}}</a>', '<br><br>', '</div>', '</div>'].join('')
   };
}]).directive('threadImg', [function () {

   function controller($scope, $element) {

      $element.on('load', function () {
         console.log(' img done.');
         $scope.itemEnd();
      }).on('error', function () {
         console.warn('img load err.');
         $scope.itemEnd();
      });
   }

   return {

      restrict: 'E',
      replace: true,
      scope: true,
      controller: controller,
      controllerAs: 'tImg',
      template: '<img ng-src="{{url}}" width="500px">'

   };
}]);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvTklYL0RvY3VtZW50cy9uaXgvdGh6LXNjcmFwZXIvc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FDQUEsT0FBTyxDQUFDLE1BQU0sQ0FBRSxLQUFLLEVBQUUsQ0FDcEIsaUJBQWlCLENBQ25CLENBQUUsQ0FDRixRQUFRLENBQUUsY0FBYyxFQUFFLDRCQUE0QixDQUFFLENBQ3hELFVBQVUsQ0FBRSxVQUFVLEVBQUUsQ0FBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLGNBQWMsRUFBRSxVQUFXLE1BQU0sRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFJOztBQUVyRyxPQUFJLEVBQUUsR0FBRyxJQUFJLENBQUM7QUFDZCxPQUFJLGdCQUFnQixHQUFHLEVBQUUsQ0FBQztBQUMxQixPQUFJLFFBQVEsR0FBRyxFQUFFLENBQUM7QUFDbEIsT0FBSSxRQUFRLEdBQUcsS0FBSyxDQUFDO0FBQ3JCLE9BQUksTUFBTSxHQUFHLElBQUksQ0FBQztBQUNsQixLQUFFLENBQUMsVUFBVSxHQUFHLEVBQUUsQ0FBQzs7QUFFbkIsS0FBRSxDQUFDLGFBQWEsR0FBRzthQUFNLE1BQU0sR0FBRyxJQUFJO0lBQUEsQ0FBQztBQUN2QyxLQUFFLENBQUMsY0FBYyxHQUFHO2FBQU0sTUFBTSxHQUFHLEtBQUs7SUFBQSxDQUFDOztBQUV6QyxLQUFFLENBQUMsT0FBTyxHQUFHLFVBQVUsS0FBSyxFQUFHOztBQUU1QixVQUFLLENBQUMsTUFBTSxJQUFJLENBQUMsS0FBSyxFQUFFO0FBQ3JCLGdCQUFPO09BQ1Q7O0FBRUQsVUFBSyxnQkFBZ0IsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFHOztBQUVoQyxXQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBRSxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsQ0FBRSxDQUFDO0FBQy9DLGdCQUFPLENBQUMs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TyxFQUFFLFlBQVk7QUFDdkIsZ0JBQU8sQ0FBQyxJQUFJLENBQUUsZUFBZSxDQUFFLENBQUM7QUFDaEMsZUFBTSxDQUFDLE9BQU8sRUFBRSxDQUFDO09BQ25CLENBQUUsQ0FBQztJQUVOOztBQUVELFVBQU87O0FBRUosY0FBUSxFQUFFLEdBQUc7QUFDYixhQUFPLEVBQUUsSUFBSTtBQUNiLFdBQUssRUFBRSxJQUFJO0FBQ1gsZ0JBQVUsRUFBVixVQUFVO0FBQ1Ysa0JBQVksRUFBRSxNQUFNO0FBQ3BCLGNBQVEsRUFBRSxzQ0FBc0M7O0lBRWxELENBQUM7Q0FFSixDQUFFLENBQUUsQ0FFSiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJhbmd1bGFyLm1vZHVsZSggJ2FwcCcsIFtcbiAgICdpbmZpbml0ZS1zY3JvbGwnXG5dIClcbi5jb25zdGFudCggJ0VORFBPSU5UX1VSSScsICdodHRwOi8vbG9jYWxob3N0OjgwMDEvYXBpLycgKVxuLmNvbnRyb2xsZXIoICdNYWluQ3RybCcsIFsgJyRzY29wZScsICckaHR0cCcsICdFTkRQT0lOVF9VUkknLCBmdW5jdGlvbiAoICRzY29wZSwgJGh0dHAsIEVORFBPSU5UX1VSSSApICB7XG5cbiAgIHZhciB2bSA9IHRoaXM7XG4gICB2YXIgbG9hZGVkVGhyZWFkTGlzdCA9IFtdO1xuICAgdmFyIGN1cnJQYWdlID0gMTM7XG4gICB2YXIgbmV4dFBhZ2UgPSBmYWxzZTtcbiAgIHZhciBjYW5BZGQgPSB0cnVlO1xuICAgdm0udGhyZWFkTGlzdCA9IFtdO1xuXG4gICB2bS5lbmFibGVBZGRNb3JlID0gKCkgPT4gY2FuQWRkID0gdHJ1ZTtcbiAgIHZtLmRpc2FibGVBZGRNb3JlID0gKCkgPT4gY2FuQWRkID0gZmFsc2U7XG5cbiAgIHZtLmFkZE1vcmUgPSBmdW5jdGlvbiggZm9yY2UgKSB7XG5cbiAgICAgIGlmICggIWNhbkFkZCAmJiAhZm9yY2UpIHtcbiAgICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCBsb2FkZWRUaHJlYWRMaXN0Lmxlbmd0aCA+IDAgKSB7XG5cbiAgICAgICAgIHZtLnRocmVhZExpc3QucHVzaCggbG9hZGVkVGhyZWFkTGlzdC5zaGlmdCgpICk7XG4gICAgICAgICBjb25zb2xlLmxvZyggJ2xvYWRpbmcgdGhyZWFkOicsIHZtLnRocmVhZExpc3QubGVuZ3RoICk7XG5cbiAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgIGNvbnNvbGUubG9nKCAnZW5kIG9mIHBhZ2UuJyApO1xuXG4gICAgICAgICBpZiAoIG5leHRQYWdlICkge1xuICAgICAgICAgICAgbG9hZFRocmVhZCgpO1xuICAgICAgICAgICAgbmV4dFBhZ2UgPSBmYWxzZTtcbiAgICAgICAgIH1cblxuICAgICAgfVxuXG4gICB9O1xuXG4gICBnbG9iYWwuTU9SRSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZtLmFkZE1vcmUoKTtcbiAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgIH07XG5cbiAgIGZ1bmN0aW9uIGxvYWRUaHJlYWQoKSB7XG5cbiAgICAgIGNvbnNvbGUubG9nKCAnbG9hZGluZyBwYWdlOicsIGN1cnJQYWdlICk7XG4gICAgICAkaHR0cC5nZXQoIEVORFBPSU5UX1VSSSArICd0aHJlYWQvJyArIGN1cnJQYWdlIClcbiAgICAgIC5zdWNjZXNzKCBmdW5jdGlvbiggbG9hZGVkVGhyZWFkTGlzdF8gKSB7XG5cbiAgICAgICAgIGNvbnNvbGUubG9nKCBsb2FkZWRUaHJlYWRMaXN0Xy5sZW5ndGggKTtcbiAgICAgICAgIGNvbnNvbGUubG9nKCBsb2FkZWRUaHJlYWRMaXN0XyApO1xuICAgICAgICAgbG9hZGVkVGhyZWFkTGlzdCA9IGxvYWRlZFRocmVhZExpc3RfO1xuXG4gICAgICAgICBjdXJyUGFnZSArKztcbiAgICAgICAgIG5leHRQYWdlID0gdHJ1ZTtcblxuICAgICAgICAgdm0uYWRkTW9yZSgpO1xuICAgICAgICAgdm0uYWRkTW9yZSgpO1xuXG4gICAgICB9IClcbiAgICAgIC5lcnJvciggZnVuY3Rpb24oIGVyciApIHtcbiAgICAgICAgIGNvbnNvbGUud2FybiggZXJyICk7XG4gICAgICB9ICk7XG5cbiAgIH1cblxuICAgbG9hZFRocmVhZCgpO1xuXG59IF0gKVxuLmRpcmVjdGl2ZSggJ3RocmVhZExpc3QnLCBbIGZ1bmN0aW9uICgpIHtcblxuICAgcmV0dXJuIHtcblxuICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgIHNjb3BlOiB0cnVlLFxuICAgICAgdGVtcGxhdGU6ICc8dGhyZWFkLWl0ZW0gbmctcmVwZWF0PVwidGhyZWFkIGluIG1haW4udGhyZWFkTGlzdFwiPjwvdGhyZWFkLWl0ZW0+J1xuXG4gICB9O1xuXG59IF0gKVxuLmRpcmVjdGl2ZSggJ3RocmVhZEl0ZW0nLCBbICckaHR0cCcsICdFTkRQT0lOVF9VUkknLCBmdW5jdGlvbiAoICRodHRwLCBFTkRQT0lOVF9VUkkgKSB7XG5cbiAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoICRzY29wZSApIHtcblxuICAgICAgJHNjb3BlLm1haW4uZGlzYWJsZUFkZE1vcmUoKTtcblxuICAgICAgJHNjb3BlLmxvYWRDb21wbGV0ZSA9IGZhbHNlO1xuICAgICAgdmFyIHRvdGFsSW1ncyA9IDA7XG4gICAgICB2YXIgbG9hZGVkID0gMDtcblxuICAgICAgJHNjb3BlLml0ZW1FbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICBsb2FkZWQgKys7XG4gICAgICAgICBpZiAoIGxvYWRlZCA+PSB0b3RhbEltZ3MgKSB7XG5cbiAgICAgICAgICAgICRzY29wZS5sb2FkQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICAgICAgJHNjb3BlLm1haW4uZW5hYmxlQWRkTW9yZSgpO1xuXG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ2NvbXBsZXRlJywgJHNjb3BlICk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nICk7XG4gICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICAkaHR0cC5wb3N0KCBFTkRQT0lOVF9VUkkgKyAncG9zdCcsIHsgdGhyZWFkOiAkc2NvcGUudGhyZWFkIH0gKVxuICAgICAgLnN1Y2Nlc3MoIGZ1bmN0aW9uKCByZXMgKSB7XG5cbiAgICAgICAgICRzY29wZS5pbWdVcmxMaXN0ID0gcmVzLmltZ1VybExpc3Q7XG4gICAgICAgICB0b3RhbEltZ3MgPSByZXMuaW1nVXJsTGlzdC5sZW5ndGg7XG5cbiAgICAgICAgIGNvbnNvbGUubG9nKCAnbG9hZGluZycsIHRvdGFsSW1ncywgJ2ltZ3MnICk7XG5cbiAgICAgICAgIGlmICggdG90YWxJbWdzID09PSAwICkge1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRDb21wbGV0ZSA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUubWFpbi5lbmFibGVBZGRNb3JlKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggJ2NvbXBsZXRlJywgJHNjb3BlICk7XG4gICAgICAgICB9XG5cbiAgICAgIH0gKVxuICAgICAgLmVycm9yKCBmdW5jdGlvbiggZXJyICkge1xuXG4gICAgICAgICBjb25zb2xlLndhcm4oICd0aHJlYWRJdGVtIGRpcmVjdGl2ZSBQT1NUIEVSUjonLCBlcnIgKTtcbiAgICAgICAgICRzY29wZS5sb2FkQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICAgJHNjb3BlLm1haW4uZW5hYmxlQWRkTW9yZSgpO1xuXG4gICAgICB9ICk7XG5cbiAgIH1cblxuICAgcmV0dXJuIHtcblxuICAgICAgcmVzdHJpY3Q6ICdFJyxcbiAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICBzY29wZTogdHJ1ZSxcbiAgICAgIGNvbnRyb2xsZXIsXG4gICAgICBjb250cm9sbGVyQXM6ICd0SXRlbScsXG4gICAgICB0ZW1wbGF0ZTogW1xuICAgICAgICAgJzxkaXY+JyxcbiAgICAgICAgICAgICc8ZGl2IG5nLWhpZGU9XCJsb2FkQ29tcGxldGVcIiBzdHlsZT1cImhlaWdodDogNTBweDsgYmFja2dyb3VuZDogI2MzYzNjM1wiPicsXG4gICAgICAgICAgICAgICAnTE9BRElORy4uLicsXG4gICAgICAgICAgICAnPC9kaXY+JyxcbiAgICAgICAgICAgICc8ZGl2IG5nLXNob3c9XCJsb2FkQ29tcGxldGVcIj4nLFxuICAgICAgICAgICAgICAgJzx0aHJlYWQtaW1nIG5nLXJlcGVhdD1cInVybCBpbiBpbWdVcmxMaXN0XCI+PC90aHJlYWQtaW1nPicsXG4gICAgICAgICAgICAgICAnPGJyPicsXG4gICAgICAgICAgICAgICAnPGEgaHJlZj1cInt7dGhyZWFkfX1cIj57e3RocmVhZH19PC9hPicsXG4gICAgICAgICAgICAgICAnPGJyPjxicj4nLFxuICAgICAgICAgICAgJzwvZGl2PicsXG4gICAgICAgICAnPC9kaXY+J1xuICAgICAgXS5qb2luKCcnKVxuICAgfTtcblxufSBdIClcbi5kaXJlY3RpdmUoICd0aHJlYWRJbWcnLCBbIGZ1bmN0aW9uICgpIHtcblxuICAgZnVuY3Rpb24gY29udHJvbGxlciggJHNjb3BlLCAkZWxlbWVudCApIHtcblxuICAgICAgJGVsZW1lbnRcbiAgICAgIC5vbiggJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICBjb25zb2xlLmxvZyggJyBpbWcgZG9uZS4nICk7XG4gICAgICAgICAkc2NvcGUuaXRlbUVuZCgpO1xuICAgICAgfSApXG4gICAgICAub24oICdlcnJvcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgIGNvbnNvbGUud2FybiggJ2ltZyBsb2FkIGVyci4nICk7XG4gICAgICAgICAkc2NvcGUuaXRlbUVuZCgpO1xuICAgICAgfSApO1xuXG4gICB9XG5cbiAgIHJldHVybiB7XG5cbiAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgc2NvcGU6IHRydWUsXG4gICAgICBjb250cm9sbGVyLFxuICAgICAgY29udHJvbGxlckFzOiAndEltZycsXG4gICAgICB0ZW1wbGF0ZTogJzxpbWcgbmctc3JjPVwie3t1cmx9fVwiIHdpZHRoPVwiNTAwcHhcIj4nXG5cbiAgIH07XG5cbn0gXSApXG5cbjtcbiJdfQ==
